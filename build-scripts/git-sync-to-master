#!/bin/smash -s

var push = false;
if (parameter[1] == '-p') push = true;

var branch = system.read("git branch | grep '*'").output.split(" ")[1];
if (branch == 'master') {
	echo.error("wrong branch for sync to master");
}

var script = [
	"git checkout master",
	"&& git merge " + branch,
  ((push === true)?"&& git push":""),
	"git checkout " + branch
];

var code = system(script.join(" "));

exit(code);
